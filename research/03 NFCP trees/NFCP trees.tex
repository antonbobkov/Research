\documentclass{amsart}

\usepackage{../AMC_style}	
\usepackage{../Research}

\usepackage{tikz}

\DeclareMathOperator{\TT}{\boldface T}
\DeclareMathOperator{\A}{\boldface A}
\DeclareMathOperator{\B}{\boldface B}
\DeclareMathOperator{\PR}{P}

\begin{document}

\title{NFCP trees}
\author{Anton Bobkov}
\email{bobkov@math.ucla.edu}
%more info

\begin{abstract}
	We investigate stable NFCP trees. 
\end{abstract}

\maketitle

\section{NFCP for stable trees}
Parigot in \cite{parigot_trees} proves that stable trees are exactly trees of finite height. Here we study them further, stating equivalent conditions for having NFCP property. Final result of this section is theorem \ref{th_tree_nfcp} where we show that having NFCP is the same as being $\aleph_0$-categorical and also provide a simple graph theoretic characterization of NFCP.

In this section all the considered trees $T$ are stable.

\begin{Definition}
Consider a tree $T$ and $n \leq m$ with $n \in \N, m \in \N \cup \{\infty\}$. Define $T \midr [n,m]$ to be the induced subtree of $T$ obtained restricting nodes at depth $[n,m]$. Call $T \midr [n, \infty]$ the \emph{$n$th-slice} of $T$.
\end{Definition}

\begin{Definition}
	Consider a tree $T$ of height $N$. Let $T_n$ denote the collection of connected components in the $n$th-slice of $T$. $T$ is called \emph{almost finite} if for every $n \leq N$, $T_n$ contains finitely many elements up to a (poset) isomorphism.
\end{Definition}

\begin{Definition}
	Given an element $t \in T$ in a tree, let $A_t = \{a \in T \mid a \geq t\}$ denote all the elements below $t$.
\end{Definition}

\begin{Definition} \label{df_coding}
	Given $T$ suppose $T_{n+1}$ is finite. We associate a coding sequence to every node at depth $n$.
	Denote all elments of $T_{n+1}$ as $C_1, \ldots, C_N$.
	Fix a node $t$ at depth $n$ and let $S$ be all the nodes at depth $n+1$ that are below $t$.
	Let $c_i \in \N \cup \{\infty\}$ be the number of elements $s \in S$ such that $A_s$ has the isomorphism class $C_i$.
	We code $t$ by sequence $\langle s_1, s_2, \ldots, s_N \rangle$
\end{Definition}


\begin{Lemma} \label{lm_tree_code}
	Suppose we have a countable tree $T$ with $T_{n+1}$ finite. Two nodes $t,s$ at depth $n$ have the same code if and only if $A_t$ is isomorphic to $A_s$.
\end{Lemma}

\begin{proof}
	Clear.
\end{proof}

\begin{Lemma} \label{lm_categoricity}
	Suppose $T$ is almost finite and countable. Then all the non-isomorphic connected components have different theories.
\end{Lemma}

\begin{Note}
	For any sentence $\phi$ we can easily construct a formula $\psi(x)$ such that
	\begin{align*}
		T \models \psi(t) \iff A_t \models \phi
	\end{align*}
\end{Note}

\begin{proof}
	Suppose the tree has depth $N$. We prove the statement by induction for $T_n$ with $n = 0..N$. Induction starts at $T_N$ and finishes at $T_0 = T$. For $T_N$ the statement is trivial as in $T_N$ all components are single nodes, so there is a unique isomorphism class. Now, suppose the statement holds for $T_{n+1}$. Label isomorphism classes in $T_{n+1}$ as $C_1, \ldots, C_N$ and pick distinguishing sentences $\phi_1, \phi_2, \ldots, \phi_N$. That is, for a node $t$ at depth $n+1$ we have 
	\begin{align*}
		A_t \models \phi_i \iff A_t \text{ has isomorphism class } C_i
	\end{align*}
	%We can easily construct formulas $\psi_1(x), \psi_2(x), \ldots, \psi_N(x)$ such that
	%\begin{align*}
	%	A_t \models \phi_i \iff T \models \psi_i(t)
	%\end{align*}
	Now pick two nodes $a,b$ at depth $n$ in different isomorphism classes. By Lemma \ref{lm_tree_code} they have different codes. That is there is $i \in [1..N]$ such that $a,b$ have different numbers cones with isomorphism class $C_i$, say $n_a \neq n_b$. Without loss of generality $n_a < n_b$. Property
	\begin{align*}
		%P(t) \iff \{s \text{ node under $t$} \midr T \models \psi_i(s)\} \text { has $n_a$ elements}
		P(t) \iff \{s \text{ node under $t$} \midr A_s \models \phi_i\} \text { has $n_a$ elements}
	\end{align*}
	is first-order definable (see Note above). This shows that $A_a, A_b$ have different theories. 
\end{proof}

\begin{Theorem} \label{th_tree_nfcp}
	Let $T$ be a stable tree of height $N$. The following are equivalent:
	\begin{enumerate}
		\item $T$ is $\aleph_0$-categorical
		\item $T$ has NFCP
		\item $T$ is almost finite
		\item Every element $t \in T$ has finitely many child cones up to a (poset) isomorphism and $T_0$ is finite.
	\end{enumerate}
\end{Theorem}

Note that conditions (3) and (4) are purely combinatorial.

\begin{proof}
	$(1) \Rightarrow (2)$. This is true in arbitrary theories. For a given arity $\aleph_0$-categorical theories have finitely many types, all of them isolated. This means that for a given formula $\phi(x, y)$ we can list all the types of $y$ for which there are infinitely many $x$ such that $\phi(x, y)$ holds. There are finitely many such types and all of them are isolated, so we can code it by single formula - disjunction of isolating formulas.
	
	$(2) \Rightarrow (3)$. We prove this by contrapositive. Suppose $T$ is not almost finite. Pick largest $n$ such that $T_n$ has infinitely many isomorphism classes. Thus $T_{n+1}$ is almost finite, thus we can code elements at depth $n$ (see Definition \ref{df_coding}). There are infinitely isomorphism classes in $T_n$, so there are infinitely many possible codes. As every code is a finite sequence, there has to be a position in the sequence that takes infinitely many possible values. More precisely, there is an isomorphism class $C$ such that with
	\begin{align*}
		N(t) = \{s \text{ node under $t$} \midr A_s \text { has isomorphism class $C$} \}
	\end{align*}
	$|N(t)|$ can take arbitrarily large values depending on $t$. Using lemma \ref{lm_categoricity} applied to $T_{n+1}$ shows that $N(t)$ is first order definable.
	
	
	Do construction as in lemma to obtain codes for nodes at depth $n$. There are infinitely many isomorphism classes for those thus there are infnitely many codes realized. As every code is a finite sequence, there has to be $i$ such $i$th position of the sequences has to take arbitrarily large finite values. Let $\phi(x,y)$ be a formula such that $\phi(T, t)$ equals to the $i$th position in the sequence coding $t$. This formula fails to have NFCP.
	
	$(3) \Rightarrow (1)$ This is exactly Lemma \ref{lm_tree_code} % not really
	
	$(3) \Leftrightarrow (4)$ Forward direction is trivial. Converse we prove this by contrapositive. Suppose $T$ is not almost finite. Pick the largest $n$ such that $T_n$ is infinite. Then $T_{n+1}$ is almost finite. If $n=0$ this contradicts $T_0$ being finite. Otherwise there has to be a node at depth $n-1$ that has infinitely many non-isomorphic nodes under it. 
\end{proof}

\begin{thebibliography}{9}

\bibitem{parigot_trees}
	Michel Parigot.
	Th\'eories d'arbres.
	\textit{Journal of Symbolic Logic}, 47, 1982.
	
\end{thebibliography}


\end{document}