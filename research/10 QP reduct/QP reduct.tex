\documentclass{amsart}

\usepackage{../AMC_style}	
\usepackage{../Research}
\usepackage{../Thm}

\usepackage{mathrsfs}

\usepackage[margin=1in]{geometry}

\usepackage{pgfpages}
\pgfpagesuselayout{2 on 1}

\renewcommand{\AA}{\mathscr A}
  \newcommand{\II}{\mathscr I}
  \newcommand{\MM}{\mathscr M}

  \newcommand{\A}{\mathcal A}
  \newcommand{\B}{\mathcal B}
\renewcommand{\C}{\mathcal C}
  \newcommand{\D}{\mathcal D}
\renewcommand{\H}{\mathcal H}
  \newcommand{\G}{\mathcal G}
  \newcommand{\M}{\mathcal M}

  \newcommand{\U}{\mathcal U}	

  \newcommand{\K}{\boldface K_\alpha}
\renewcommand{\S}{S_\alpha}

\newcommand{\curly}[1]{\left\{#1\right\}}
\newcommand{\paren}[1]{\left(#1\right)}
\newcommand{\abs}[1]{\left|#1\right|}

\providecommand{\floor}[1]{\left \lfloor #1 \right \rfloor }

\DeclareMathOperator{\Sg}{Sg}
\DeclareMathOperator{\Bt}{Bt}
\DeclareMathOperator{\Pt}{Pt}
\DeclareMathOperator{\Ct}{Ct}
\DeclareMathOperator{\vecspan}{span}
\DeclareMathOperator{\val}{val}



\title{VC-density in an additive reduct of p-adic numbers}
\author{Anton Bobkov}
\email{bobkov@math.ucla.edu}

\begin{document}

\begin{abstract}
	\cite{density} computed a bound $2n+1$ for the VC function in p-adic numbers, but it is not known to be optimal.
	I investigate a C-minimal additive reduct of p-adic numbers and using techniques of \cite{reduct} I compute an optimal bound $n$ for that structure.
\end{abstract}


\maketitle

VC density was introduced in \cite{density} by Aschenbrenner, Dolich, Haskell, MacPherson, and Starchenko as a natural notion of dimension for NIP theories.
In a NIP theory we can define the VC function

\begin{align*}
	\vc : \N \arr \N
\end{align*}

Where $vc(n)$ measures complexity of definable sets in an $n$-dimensional space.
Simplest possible behavior is $\vc(n) = n$ for all $n$.
\cite{density} computes an upper bound for this function to be $2n+1$, and it's not known whether it's optimal.
This same bound would hold in any reduct of p-adic numbers, so one may hope that the simplified structure of the reduct would allow a better bound.
In \cite{reduct}, Leenknegt provides a cell decomposition result for the C-minimal additive reduct of p-adic numbers.
Using that I'm able to improve the bound for the VC function, showing that $\vc(n) = n$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Cell Decomposition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


We work with the reduct of p-adic numbers in the language $\L = \curly{\Q_p, Q_{n,m}, +, -, \curly{\bar c}_{c \in K} }$,
where $\bar c$ is a scalar multiplication by $c$, and $Q_{n,m}$ is a unary predicate

\begin{align*}
	Q_{n,m} = \curly{\bigcup_{k \in \Z} p^{kn} (1 + p^m\Z_p) }
\end{align*}

\cite{reduct} provides a cell decomposition result for this structure.
Any formula $\phi(t, x)$  with $t$  singleton decomposes as the union of the following cells:

\begin{align*}
	\curly{(x, t) \in D \times K \mid \val a_1(x) \square_1 \val (t - c(x)) \square_2 \val a_2(x), t - c(x) \in \lambda Q_{n,m} }
\end{align*}

where $D$ is a cell of a smaller dimension, $a_1, a_2, c$ are linear polynomials in  $x$, $\square$ is $<$ or no condition, $\lambda  \in\Q_p$.

We analyze a formula $\phi(x; y)$ to find an upper bound of its VC-density. 
Using cell decomposition, without loss of generality we may assume that we only need to bound the following family of formulas $\Psi (x,y)$

\begin{align*}
	&\val p_i(x) - c_i(y) < \val p_j(x) - c_j(y) & i, j \in I \\
	&\val p_i(x) - c_i(y) \in \lambda_k Q & i \in I , k \in K
\end{align*}

where $I, K$ some finite index sets, $p_i$ is linear in $x$, $c_i$ is a linear polynomial in $y$, $\lambda_k \in \Q_p$, and $Q = Q_{n,m}$ for some $n',m'$.

To see that apply cell decomposition theorem to $\phi(x_1, \bar x; y)$.
Extract from the cells all the polynomials $a_1(\bar x, y), a_2(\bar x, y), x_1 - c(\bar x, y)$, and separate $x$ and $y$ parts into $p_i(x) - c_i(y)$.
Choose $n',m'$ large enough to cover all $n,m$ that come up in the cells.
Finally choose $\lambda_k$ to go over all cosets of $Q$.

Then $(x,y),(x',y')$ agreeing on $\Psi$, will agree on being contained in those cells, and thus will agree on satisfying $\phi$.

%\begin{Definition}
	%\begin{itemize}
		%\item For $a \in \Q_p$ and $\alpha < \beta \in \Z$ we denote $a \midr [\alpha, \beta]$ the part of the $p$-adic restricted to $[\alpha, \beta]$
		%\item By $a \midr \alpha$ we mean $a \midr (-\infty, \alpha)$.
		%\item By $a = b \ (\midr \alpha)$ we mean $a \midr \alpha = b \midr \alpha$.
	%\end{itemize}
%\end{Definition}
%
%\begin{Claim}
	%\begin{itemize}
		%\item If $a = b \ (\midr \alpha)$ and $c = d \ (\midr \alpha)$ then $a + c = b + d \ (\midr \alpha)$.
		%\item If $a = b \ (\midr \alpha)$ and $v(c) = 0$ then $ca = cb \ (\midr \alpha)$
		%\item More generally if $a = b \ (\midr \alpha)$ then $ca = cb \ (\midr \alpha + v(c))$
	%\end{itemize}
%\end{Claim}

%\begin{Claim}
	%Suppose we have a system 
	%\begin{align*}
		%\curly{ \sum \alpha_{ij} x_i }_{j \in J}
	%\end{align*}
	%with $j \in J$. There exists $\gamma$ with the following property.
	%Pick any subset $J' \subset J$ of equations and $\alpha$. Suppose we are given
	%\begin{align*}
		%\curly{ \sum \alpha_{ij} x_i = c_j \ (\midr \alpha)}_{j \in J'}
	%\end{align*}
	%and suppose those equations are enough to determine $\sum \alpha_{ij'} x_i$ for some $j' \in J$.
	%That is writing $\vec v_j = (\alpha_{1j}, \ldots, \alpha_{Ij})$ we have
	%that $v_{j'}$ is a linear combination of vectors $\{v_j\}_{j \in J'}$
	%Then $\sum \alpha_{ij'} x_i$ is determined up to $\alpha - \gamma$
%\end{Claim}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Key Lemmas and Definitions}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{Definition}
	A tuple $p \in  \Q_p^m$ can be viewed as a vector $\vec p$, treating $\Q_p^m$ as a vector space over $\Q_p$.
\end{Definition}

We may rewrite our collection of formulas $\Psi(x, y)$ as

\begin{align*}
	&\val (\vec p_i \cdot \vec x) - c_i(y) < \val (\vec p_j \cdot \vec x) - c_j(y) & i, j \in I \\
	&\val (\vec p_i \cdot \vec x) - c_i(y) \in \lambda_k Q & i \in I , k \in K
\end{align*}

\begin{Lemma}	 \label{gamma}
	Suppose we have a collection of vectors $\curly{\vec p_i}_{i \in I}$ with each $\vec p_i \in \Q_p^m$.
	Pick a subset $J \subset I$ and $j \in I$ such that
	\begin{align*}
		\vec p_j \in \vecspan \curly{\vec p_i}_{i \in J} 
	\end{align*}
	Suppose we have $\vec x \in \Q_p^m, \alpha \in \Z$ with
	\begin{align*}
		\val(\vec p_i \cdot \vec x) > \alpha \text{ for all } i \in J
	\end{align*}
	Then
	\begin{align*}
		\val(\vec p_j \cdot \vec x) > \alpha - \gamma
	\end{align*}
	for some $\gamma \in \Z^{\geq 0}$.
	Moreover $\gamma$ can be chosen independent of choice of $J, j, \vec x, \alpha$ depending only on $\curly{\vec p_i}_{i \in I}$ independent of their order.
\end{Lemma}


\begin{Definition}
	For $c \in \Q_p, \alpha \in \Z$ we define an open ball 
	\begin{align*}
		B(c, \alpha) = \curly{c' \in \Q_p \mid \val \paren{c' - c} \leq \alpha}
	\end{align*}
\end{Definition}

\begin{Definition}
	Suppose we have a finite $T \subset \Q_p$.
	We view it as a tree as follows.
	Branches through the tree are elements of $T$.
	With this tree we associate open balls $B(t_1, \val(t_1 - t_2))$ for all $t_1, t_2 \in T$.
	An interval is two balls $B(t_1, v_1) \supset B(t_2, v_2)$ with no balls in between.
	An element $a \in \Q_p$ belongs to this interval if $a \in B(t_1, v_1) \backslash B(t_2, v_2)$.
	There are at most $2|T|$ different intervals and they partition the entire space.
	
	Fix a parameter set $B$ of size $N$.
	
	Consider a tree $T = \curly{c_i(b) \mid b \in B, i \in I}$
	It has at most $O(N) = N \cdot |I|$ many intervals.
	Denote the set of all intervals as $\Pt$.
	For the remainder of the paper we work with this tree.	
\end{Definition}


\begin{Definition}
	$a, a' \in \Q_p^m$ have the same $\Psi$-type if they have the same $\Psi$ type over $B$.	
\end{Definition}

\begin{Definition}
	$x, x' \in \Q_p$ have the same tree type if
	\begin{itemize}
		\item $x + c_i(b)$ is in the same $Q$-coset as $x' + c_i(b)$ for all $i \in I, b \in B$
		\item $\val(x + c_i(b)) < \val(x + c_j(b))$ iff $\val(x' + c_i(b)) < \val(x' + c_j(b))$ for all $i,j \in I, b \in B$
	\end{itemize}
\end{Definition}
 
\begin{Lemma}
	Let $a, a' \in \Q_p^m$.
	If $p_i(a), p_i(a')$ have the same tree type for all $i \in I$, then $a, a'$ have the same $\Psi$-type.
\end{Lemma}

The following lemma is an adaptation of lemma 7.4 in \cite{density}.

\begin{Lemma}
	For $n,m$ there exists $D = D(n,m) \in \Z$ such that for any $x,y,a \in \Q_p$ if
	\begin{align*}
		\val (x - a) = \val (y - a) < \val (x - y) - D
	\end{align*}
	then $x - a, y - a$ are in the same coset of $Q_{n,m}$.
\end{Lemma}

Next lemma is along the lines of lemma 7.5 of \cite{density}.

\begin{Lemma}
	Using $D$ from the previous lemma define an enumeration of near balls
	\begin{align*}
		B_1(c, \alpha), B_2(c, \alpha), \ldots B_{N_D}(c, \alpha)
	\end{align*}
\end{Lemma}

\begin{Definition}
	Let $c \in \Q_p$.
	It lies in our tree in one of the intervals $B(c_L, \alpha_L) \backslash B(c_U, \alpha_U)$.
	Suppose $c$ lies in one of the near balls corresponding to $B(c_L, \alpha_L)$ or $B(c_U, \alpha_U)$.
	Then define its interval type to be the index of that near ball.
	Otherwise define its interval type to be the coset of $c - c_U$ of $Q$.
	Denote the space of all the possible branch types $\Bt$.
	We have
	\begin{align*}
		|\Bt| = N_D + \text {number of cosets of $Q$}
	\end{align*}
	depending only on $\Psi$, independent from $B$.
	
\end{Definition}

\begin{Lemma}
	If $c, c'$ are in the same interval and have the same interval type then they have the same tree type.
\end{Lemma}

\begin{Definition}
	For $c \in \Q_p$ and $\alpha, \beta \in \Z$ let $c \midr [\alpha, \beta] \in \Z/p\Z^{\beta - \alpha}$ be the record of coefficients of $c$ for valuations between $\alpha, \beta$. More precisely write $c$ in its power series form
	\begin{align*}
		c = \sum_{\gamma \in Z} c_\gamma p^\gamma \text{ with } c_\gamma \in \Z/p\Z
	\end{align*}
	Then $c \midr [\alpha, \beta]$ is just $(c_\alpha, c_{\alpha+1}, \ldots c_\beta)$.
\end{Definition}
\begin{Definition}
	Let $c \in \Q_p$.
	It lies in our tree in one of the intervals $B(c_L, \alpha_L) \backslash B(c_U, \alpha_U)$.
	Define $F(c)$, the floor of $c$ to be $\alpha_L$.
\end{Definition}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Main Proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Fix $\gamma$ corresponding to $\curly{\vec p_i}_{i \in I}$ according to Lemma \ref{gamma}.

\begin{Definition}
	Denote $\Z/p\Z^\gamma$ as $\Ct$.
\end{Definition}

\begin{Definition}
	Let $f: \Q_p^n \arr \Q_p^I$ with $f(\bar c) = (p_i(\bar c))_{i \in I}$.
	Define segment space $\Sg$ to be the image of $f$.	
\end{Definition}


Given a tuple $(a_i)_{i\in I}$ in segment space look at corresponding floors $\curly{F(a_i)}_{i\in I}$.
Those are ordered as elements of $\Z$
Partition the segment space by order type of $\{F(a_i)\}$.
Work in a fixed partition $\Sg'$.
After relabeling we may assume that
\begin{align*}
	F(a_1) \geq F(a_2) \geq \ldots 
\end{align*}

Consider (relabeled) sequence of vectors $\vec p_1, \vec p_2, \ldots, \vec p_I$.
There is a unique subset $J \subset I$ such that all vectors with indices in $J$ are linearly independent, and all vectors with indices outside of $J$ are a linear combination of preceding vectors.
For any index $i \in I$ we call it independent if $i \in J$ and we call it dependent otherwise.
%Let $m = |J|$.

Now, we define the following function
\begin{align*}
	g: \Sg' \arr \Bt^I \times \Pt^J \times \Ct^{I - J}
\end{align*}

Let $\bar a = (a_i)_{i\in I} \in \Sg'$.
To define $g(\bar a)$ we need to specify where it is taking in each individual component of the product.

For all $a_i$ record its interval type $\in \Bt$ giving the first component.

For $a_j$ with $j \in J$, record the interval of $a_j$ giving the second component.

For the third component to the following computation.
Pick $a_i$ with $i$ dependent.
Let $j$ be the largest independent index with $j < i$.
Record $a_i \midr [F(a_j) - \gamma, F(a_j)]$.



\begin{Lemma}
	For $\bar a, \bar a' \in \Sg'$ if $g(\bar a) = g(\bar a')$ then $a_i, a_i'$ have the same tree type for all $i \in I$.	
\end{Lemma}

\begin{proof}
	Suppose we have $\bar a, \bar a' \in \Sg'$ that map to the same image by $g$.
	Suppose $i$ is independent.
	Then by construction, $a_i, a_i'$ map to the same interval of the tree and have the same interval type.
	Thus they have the same tree type.
	Otherwise, suppose $i$ is dependent.
	Pick largest $j < i$ such that $j$ is independent.
	We have $F(a_i) \leq F(a_j)$ and $F(a_i') \leq F(a_j')$.
	Moreover $F(a_j) = F(a_j')$ as they are mapped to the same interval (as $j$ is independent).
	
	\begin{Claim}
		$\val(a_i - a_i') > F(a_j) - \gamma$
	\end{Claim}
	\begin{proof}
		Let $\bar x, \bar x' \in \Q_p^m$ be some elements with
		\begin{align*}
			\vec p_k &\cdot \bar x = a_k \\
			\vec p_k &\cdot \bar x' = a_k' \text { for all } k \in I
		\end{align*}
		Let $J$ be the set of independent indices less than $i$.
		We have 
		\begin{align*}
			\val(a_k - a_k') > F(a_k) \text { for all } k \leq J
		\end{align*}
		as for independent indices $a_k, a_k'$ lie in the same interval.
		\begin{align*}
			&\val(a_k - a_k') > F(a_j) \text { for all } k \leq J \text{ by monotonicity of $F(a_k)$} \\
			&\val(\vec p_k \cdot \bar x - \vec p_k \cdot \bar x') > F(a_j) \text { for all } k \leq J \\
			&\val(\vec p_k \cdot (\bar x - \bar x')) > F(a_j) \text { for all } k \leq J \\
		\end{align*}
		$J$ and $i$ match the requirements of the claim above by independence so we conclude
		\begin{align*}
			&\val(\vec p_i \cdot (\bar x - \bar x')) > F(a_j) - \gamma \\
			&\val(\vec p_i \cdot \bar x - \vec p_i \cdot \bar x') > F(a_j) - \gamma \\
			&\val(a_i - a_i')) > F(a_j) - \gamma
		\end{align*}
		as needed.
	\end{proof}
	
	By record of continuations (which $a_i, a_i'$ agree on) we have
	\begin{align*}
		a_i = a_i' \midr F(a_j)
	\end{align*}
	As $F(a_i) \leq F(a_j)$, $a_i, a_i'$ have to lie in the same interval.
	They also agree on interval type.
	Thus they have the same tree type.
	
\end{proof}

Now suppose we have $c, c' \in \Q_p^m$ such that $g(f(c)) = g(f(c'))$.
Then $f(c)$ components have the same tree type as $f(c')$ components.
Then $c, c'$ have the same $\Psi$-type.
Thus the number of possible $\Psi$-types is bound by the size of the range of $g$.

\begin{align*}
	|\Ct| &= p^\gamma \\
	|\Pt| &\leq N \cdot I^2 \text { (the only component dependent on $N$)}
\end{align*}
Moreover we need at most $I!$ many partitions of $\Sg$. This gives us

\begin{align*}
	I! \cdot |Bt|^I \cdot (N \cdot I^2)^m \cdot p^{\gamma I} = O(N^m)
\end{align*}

upper bound for the possible number of $\Psi$-types.

\begin{thebibliography}{9}
	\bibitem{density}
		M. Aschenbrenner, A. Dolich, D. Haskell, D. Macpherson, S. Starchenko,
		\textit{Vapnik-Chervonenkis density in some theories without the independence property}, I, preprint (2011)
	\bibitem{reduct}
		insert citation
\end{thebibliography}

\end{document}








