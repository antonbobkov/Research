\documentclass{amsart}

\usepackage{../AMC_style}	
\usepackage{../Research}
\usepackage{../Thm}


  \newcommand{\A}{\mathcal A}
  \newcommand{\B}{\mathcal B}
\renewcommand{\C}{\mathcal C}
  \newcommand{\D}{\mathcal D}
\renewcommand{\H}{\mathcal H}
  \newcommand{\G}{\mathcal G}
  \newcommand{\M}{\mathcal M}

  \newcommand{\K}{\boldface K_\alpha}
\renewcommand{\S}{S_\alpha}

\newcommand{\curly}[1]{\left\{#1\right\}}
\newcommand{\paren}[1]{\left(#1\right)}
\newcommand{\abs}[1]{\left|#1\right|}

\providecommand{\floor}[1]{\left \lfloor #1 \right \rfloor }

%\DeclareMathOperator{\dim}{dim}

\title{Some vc-density computations in Shelah-Spencer graphs}
\author{Anton Bobkov}
\email{bobkov@math.ucla.edu}

\begin{document}

\maketitle

Fix a formula $\phi(x, y)$ that is a minimal extension $\curly{M_i}_{i \in [0..k]}$ with $M_0 = \{x, y\}$ with
\begin{itemize}
	\item there are no edges between $x$ and $y$.
	\item there are no edges between $x$.
	\item Let $\dim \paren{M_i/M_{i-1}} = -\epsilon_i$.
	\item Let $\epsilon_L = \sum_{[1..k]} \epsilon_i$.
	\item Let $\epsilon_U = \min_{[1..k]} \epsilon_i$.
	\item Let $Y = \dim (y)$
\end{itemize}

Fix a parameter set $A$, strongly embedded and disconnected (thus indiscernible).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Lower bound}

Let $n$ be the integer such that $n \epsilon_L < Y$ and $(n+1) \epsilon_L > Y$.

Pick a finite $B \subset A^{|x|}$.

Consider the graph $y$.
If $y$ is not positive, then $\phi$ has no realizations over $B$.
Otherwise, take an abstract realization of $y$, and label it by $b$.

Fix $n$ arbitrary elements of $B$, label them $a_i$, with each $|a_i| = |x|$.
Abstractly adjoin $M_i/\curly{a_i, b} = M/\curly{x,y}$ for each $i$.
Let $\bar M = \bigcup M_i$ (disjointly).

\begin{Claim}
	$(A \cap \bar M) \leq \bar M$.
\end{Claim}
\begin{proof}
	It's total dimension is $Y - n\epsilon_L > 0$ and all subextensions are positive as well.
\end{proof}

Thus a copy of $\bar M$ can be embedded over $A$ into our ambient model.
Choice of elements of $B$ was arbitrary, thus showing that any $n$ elements can be traced out.
Thus we have $O(|B|^n)$ many traces showing $\vc$-density of at least $n$.

\begin{align*}
	\vc(\phi) \geq \floor{\frac{Y}{\epsilon_L}}
\end{align*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Upper bound}

Pick a trace of $\phi(x,y)$ on $A^{|x|}$ by a parameter $b$.

\begin{align*}
	B = \curly{a \in A^{|x|} \mid \phi(a, b)}
\end{align*}

Pick $B' \subset B$, ordered $B' = \{a_1, \ldots\}$ such that
\begin{align*}
	a_i \cap \bigcup_{j \neq i} a_j \neq \emptyset
\end{align*}
This is always possible by starting with $B$ and taking away elements one by one.
Call such a set a \emph{generating set} of $B$.

Let $M_i / \{a_i, b\}$ be a witness of $\phi(a_i, b)$.
Let $\bar M = \bigcup M_i$.
Consider $\bar M / A$.

Pick $\bar M$ such that $\dim(\bar M / A)$ is maximized.

$\bar M \cap A \leq \bar M$ as $A$ is strong. (Make sure $M$ is not too big!)
Let $\bar A = A - \curly{a_i}_{i \in I}$.
Suppose $\bar A \cap \bar M \neq \emptyset$.
Then we can abstractly reembed $\M$ over $A$ such that $\bar A \cap \bar M = \emptyset$.
This would increase the dimension, contradicting maximality.
Thus we can assume $A \cap \bar M = \{a_i\}_{i \in I}$

Suppose there is $j$ such that
\begin{align*}
	M_j \cap \bigcup_{i \neq j} M_i \neq \emptyset
\end{align*}

Let $\bar M' = \bigcup_{i \neq j} M_i$.
Apply lemma to $\bar M' \cup \{a_j\}$ and $M_j / \{a_j, b\}$.
There are two cases
\begin{enumerate}
	\item $M_j \subset \bar M' \cup \{a_j\}$.
	In this case there are edges between $\{a_j\}$ and $M_j$ that contribute to dimension less than $-\epsilon$.
	\item Otherwise $M_j$ adds extra dimension less than $-\epsilon_U$
\end{enumerate}

Adding it all up $\dim(\bar M / A) \leq -\epsilon_U n$ yielding the upper bound.

% Thus as $A$ is strong we need $|B'| \epsilon < Y$.
This gives us $|B'| \leq n$.
Finally we need to relate $|B'|$ to $|B|$.

Suppose we have $C \subset A^{|x|}$, finite with $|C| = N$.
A generating set for a trace has to have size $\leq n$.
Thus there are ${N \choose n} \leq N^n$ choices for a generating set.
A set generated from set of size $n$ can have at most $(x|n|)^{|x|}$ elements.
Thus a given set of size $n$ can generate at most
\begin{align*}
	2^{(x|n|)^{|x|}}
\end{align*}
sets.
Thus the number of possible traces on $C$ is bounded above by
\begin{align*}
  2^{(x|n|)^{|x|}} \cdot N^n = O(N^n)
\end{align*}
This bounds the vc-density by $n$.

Lemma

Suppose we have a set $B$ and a minimal pair $(M, A)$ with $A \subset B$ and $\dim(M/A) = -\epsilon$.
Then either $M \subseteq B$ or $\dim((M \cup B)/B) < -\epsilon$.

Proof

By diamond construction

\begin{align*}
	\dim((M \cup B)/B) \leq \dim(M / (M \cap B))
\end{align*}

and 

\begin{align*}
	\dim(M / (M \cap B)) &= \dim (M/A) - \dim(M / (M \cap B)) \\
	\dim (M/A) &= -\epsilon \\
	\dim(M / (M \cap B)) &> 0
\end{align*}


Lemma

Suppose we have a set $B$ and a minimal chain $M_n$ with $M_0 \subset B$ and dimensions $-\epsilon_i$.
Let $\epsilon$ be the minimal of $\epsilon_i$.
Then either $M_n \subseteq B$ or $\dim((M_n \cup B)/B) < -\epsilon$.

Proof

Let $\bar M_i = M_i \cup B$

\begin{align*}
	\dim(\bar M_n/B) = \dim(\bar M_n/\bar M_{n-1}) + \ldots + \dim(\bar M_2/\bar M_1) + \dim(\bar M_1/B)
\end{align*}

Either $M_n \subseteq B$ or one of the summands above is nonzero.
Apply previous lemma.

\end{document}

% Add minimal extension construction
% Add complete graph counterexample
% Add indiscernible sequence proofs, example of non-strong ind. seq